{"script_uid":"beacon-qht40-y9ea7r5-57j36j-fu76","category":[{"iso":"ru","value":"/Маяки"},{"iso":"en","value":"/Beacons"},{"iso":"es","value":"/Balizas"},{"iso":"de","value":"/Leuchten"}],"name":[{"iso":"ru","value":"Маяк"},{"iso":"en","value":"Beacon"},{"iso":"es","value":"Baliza"},{"iso":"de","value":"Leuchte"}],"description":[{"iso":"ru","value":"Назначение: Меняет состояние выхода в зависимости от состояния «Взят/Снят», и «Тревога» в отслеживаемых разделах.\n\nЛогика работы:\n    Выход включается при постановке на охрану всех отслеживаемых разделов;\n    Выход выключается при снятии с охраны любого из отслеживаемых разделов;\n    Выход отключается, при частичном взятии отслеживаемых разделов, на короткие интервалы времени с большой периодичностью;\n    Выход включается и выключается с заданной периодичностью при тревоге в любом из отслеживаемых разделов.\n\nОсобенности:\nУчитывается задержка на Вход и Выход;\nРежим отображения состояния «Взят/Снят», только для охранных разделов;\nРежим частичного взятия «Я дома».\nОбрабатывается событие «Паника»"},{"iso":"en","value":"Purpose: Changes the state of the output depending on the \"Armed/Disarmed\" and \"Alarm\" status in the monitored partitions.\n\nOperation logic:\n The output is switched on when all monitored partitions are armed;\n The output is switched off when any of the monitored partitions is disarmed partitions;\n The output is turned off, when the monitored partitions are partially taken, for short time intervals with a high frequency;\n The output turns on and off at a specified frequency in case of an alarm in any of the monitored partitions.\n\nFeatures:\nDelay for Entry and Exit is taken into account;\nStatus display mode \"Armed/Disarmed\", only for security partitions;\nPartial arming mode \"I'm at home\".\nThe Panic event is being processed"},{"iso":"es","value":"Propósito: Cambia el estado de la salida dependiendo del estado \"Armado/Desarmado\" y \"Alarma\" en las particiones monitoreadas.\n\nLógica de operación:\n La salida se enciende cuando todas las particiones monitoreadas están armadas;\n La salida se apaga cuando alguna de las particiones monitoreadas está desarmada;\n La salida se apaga, cuando las particiones monitoreadas están parcialmente tomadas, por intervalos de tiempo cortos con una alta frecuencia;\n La salida se enciende y apaga en un frecuencia especificada en caso de alarma en cualquiera de las particiones monitoreadas.\n\nCaracterísticas:\nSe tiene en cuenta el retardo de entrada y salida;\nModo de visualización de estado \"Armado/Desarmado\", solo para particiones de seguridad;\nModo de armado parcial \"Estoy en casa\".\nEl evento Pánico se está procesando"},{"iso":"de","value":"Zweck: Ändert den Status des Ausgangs in Abhängigkeit vom Zustand \"Scharf/Unscharf\" und \"Alarm\" in den überwachten Bereichen.\n\nBetriebslogik:\n Der Ausgang wird eingeschaltet, wenn alle überwachten Bereiche scharfgeschaltet sind;\n Der Ausgang wird ausgeschaltet, wenn einer der überwachten Bereiche unscharf geschaltet wird;\n Der Ausgang wird ausgeschaltet, wenn der überwachte Bereich für kurze Zeitintervalle mit hoher Frequenz teilweise besetzt ist;\n Der Ausgang schaltet ein und aus bei a festgelegte Häufigkeit im Falle eines Alarms in einem der überwachten Bereiche.\n\nEigenschaften:\nEintritts- und Austrittsverzögerung wird berücksichtigt;\nStatusanzeigemodus \"Scharf/Unscharf\", nur für Sicherheitsbereiche;\nTeilscharfmodus \"Ich bin zu Hause\".\nDas Panikereignis wird verarbeitet"}],"description_alt":[{"iso":"ru","value":"<u><i>Назначение:</i></u> Меняет состояние выхода в зависимости от состояния «Взят/Снят», и «Тревога» в отслеживаемых разделах.<br><br><u><i>Логика работы:</i></u><br>    Выход включается при постановке на охрану всех отслеживаемых разделов;<br>    Выход выключается при снятии с охраны любого из отслеживаемых разделов;<br>    Выход отключается, при частичном взятии отслеживаемых разделов, на короткие интервалы времени с большой периодичностью;<br>    Выход включается и выключается с заданной периодичностью при тревоге в любом из отслеживаемых разделов.<br><br><u><i>Особенности:</i></u><br>Учитывается задержка на Вход и Выход;<br>Режим отображения состояния «Взят/Снят», только для охранных разделов;<br>Режим частичного взятия «Я дома».<br>Обрабатывается событие «Паника»"},{"iso":"en","value":"<u><i>Purpose:</i></u> Changes the output state depending on the Armed/Disarmed status, and the Alarm status in the monitored partitions.<br><br><u><i>Operating logic:</i></u><br>    The output is switched on when all monitored partitions are armed;<br>    The output is switched off when any of the monitored partitions is disarmed;<br>    The output is disabled when the monitored partitions are partially armed for short time intervals<br><br><u><i>Features:</i></u><br>Delays for Entry and Exit are taken into account;<br>Armed/Disarmed status display mode, only for security partitions;<br>Partial arming mode \"I'm at home\".<br>The \"Panic\" event is being processed"},{"iso":"es","value":"<u><i>Propósito:</i></u> Cambia el estado de salida dependiendo del estado Armado/Desarmado y el estado de Alarma en las particiones monitoreadas.<br><br><u><i>Lógica de operación:</i></u><br>    La salida se enciende cuando todas las particiones monitoreadas están armadas;<br>     La salida se apaga cuando cualquiera de las particiones monitoreadas está desarmada;<br>    La salida se desactiva cuando las particiones monitoreadas están parcialmente armados por breves intervalos de tiempo<br><br><u><i>Características:</i></u><br>Se toman en cuenta los retrasos de entrada y salida;<br>Modo de visualización de estado Armado/Desarmado, solo para particiones de seguridad;<br>Modo de armado parcial \"Estoy en casa\".<br>El evento \"Pánico\" se está procesando"},{"iso":"de","value":"<u><i>Zweck:</i></u> Ändert den Ausgangszustand in Abhängigkeit vom Scharf-/Unscharf-Status und vom Alarmstatus in den überwachten Bereichen.<br><br><u><i>Betriebslogik:</i></u><br>     Der Ausgang wird eingeschaltet, wenn alle überwachten Bereiche scharfgeschaltet sind;<br>    Der Ausgang wird ausgeschaltet, wenn einer der überwachten Bereiche unscharf geschaltet wird;<br>    Der Ausgang wird deaktiviert, wenn die überwachten Bereiche deaktiviert sind sind für kurze Zeitintervalle teilweise scharf geschaltet<br><br><u><i>Eigenschaften:</i></u><br>Verzögerungen beim Ein- und Aussteigen werden berücksichtigt;<br>nur Zustandsanzeigemodus Scharf/Unscharf für Sicherheitspartitionen;<br>Teilscharfmodus \"Ich bin zu Hause\".<br>Das Ereignis \"Panik\" wird verarbeitet"}],"source":"delay_blink_mask equ 256 ; mask of delay indication\nim_home_blink_mask equ 1792 ; mask of i am home indication\nalarm_mask equ 128 ; mask of alarm indication\n\n;sections equ 7 ; (param) monitored sections\n;enable_panic equ 0 ; (param) flag if need to check panic\n;enable_im_home equ 0 ; (param) flag if i am home mode is enabled\n;all_section_types equ 0 ; (param) flag if need to check all types of sections\n;indicate_delays equ 1 ; (param) flag if need to indicate delays\n\n; common TOS sizes\nb equ 0\nw equ 1\ndw equ 2\n\n; results\noff equ 0\non equ 1\n\npb macro ; byte\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\npw macro ; word\n psh (($1 >> 12) & 15)\n nib (($1 >> 8) & 15)\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; mov instruction with parameters\nup macro\n psh (((($1 & 3) | ($2 << 2)) >> 4) & 15)\n nib (($1 & 3) | ($2 << 2) & 15)\n mov\nendm\n\n; exp instruction with parameters\nex macro\n psh ($1 & 3)\n nib ((($3 & 1) << 3) | ($2 & 3))\n exp\nendm\n\n; find mask of section\n; (shift 1 left while section number > 0)\nfind_section_mask macro\n dec b  ; 'section number' - 1\n psh $1 ; initiate mask\n shl 1  ; shift left mask\n swp b  ; bring 'section number' up\n dec b  ; 'section number' - 1\n ; if 'section number' is 0 - dispose 'section number' and leave macro\n ; else - bring mask up and continue shifting\n snz\n bra 2\n swp b  ; bring mask up\n bra -7\n pop b  ; dispose 'section number'\nendm\n\n; BEGIN\n ; TOS on entry:\n ; b: previous result\n \n\n \nstart\n pop b ; dispose 'last state'\n \n ; get alarming sections mask\n pb ALARMING_SECTIONS\n inp b, b\n pb sections ; get monitored sections mask\n and b ; calculate monitored alarming sections mask\n pop b ; read result\n ; if there any section is alarming - alarm\n ; else - check if panic is enabled\n skz\n bra alarm\n \ncheck_panic_enabled\n ; get oanic is enabled flag\n psh enable_panic\n ; read\n pop b\n ; if enabled - check panic\n ; else - check delay indication flag\n snz\n bra check_delay_indication_flag\n \ncheck_panic\n ; get panic flag\n pb PANIC\n inp b, b\n ; read panic flag\n pop b\n ; if has panic - alarm\n ; else - check delay indication flag\n snz\n bra check_delay_indication_flag\n\nalarm\n ; get current ticks\n pb TICKS\n inp b, b\n ; get alarm mask\n pb alarm_mask\n ; calculate ticks matching the alarm mask\n and b\n ; read result\n pop b\n ; if match - set on\n ; else - set off\n skz\n psh on ; set on\n ret\n \ncheck_delay_indication_flag\n ; get flag that tells indicate delays or not\n psh indicate_delays\n ; read flag\n pop b\n ; if has flag - check zones\n ; else - check arming\n skz\n bra check_zones\n pb check_arming\n jmp b\n\ncheck_zones\n pw ZONE_SECTION_BASE ; put to stack address of section number of first zone\nloop\n dup w ; save address of 'section number of current zone'\n inp w, b ; get 'section number of current zone'\n dup b ; save 'section number of current zone'\n ; check if section number is anything but 1 or 0\n ; if yes - find section mask\n ; else - continue\n pb 254 ; anything but 1 or 0\n and b\n pop b\n snz\n bra check_section_monitored\n find_section_mask 1\ncheck_section_monitored\n ; check if that section is monitored\n pb sections\n and b\n pop b\n ; if monitored - check delay\n ; else - check next zone\n skz\n bra check_delay ; zone to check\n\ncheck_end_loop\n inc w ; increase address of 'section number of zone'\n dup w ; save 'section number of next zone'\n ; check if it was last zone number\n pw 4128\n ; if it was last - dispose, go check arming\n ; else - continue loop\n cmp w\n skz\n bra loop\n pb no_alarm_dispose\n jmp b\n \ncheck_delay\n dup w ; save address of 'section number of current zone'\n pw ZONE_SECTION_BASE ; get address of 'section number of first zone'\n sub w ; calculate 'number of current zone'\n dup w ; save 'number of current zone'\n pw ZONE_EXITDELAY_FLAG_BASE ; get base address of 'zone exit delay flag'\n add w ; calculate address of 'current zone exit delay flag'\n inp w, b ; get 'current zone exit delay flag'\n ; if has 'zone exit delay flag' - procedure delay\n ; else - check entry delay\n skz\n bra delay\n pop b ; dispose 'zone exit delay flag'\n ; get base address of 'zone entry delay flag'\n pw ZONE_ENTRYDELAY_FLAG_BASE\n add w ; calculate address of 'current zone entry delay flag'\n inp w, b ; get 'current zone entry delay flag'\n ; if has 'entry delay flag' - procedure delay\n ; else - check if it was last zone\n skz\n bra delay\n pop b ; dispose 'zone entry delay flag'\n bra check_end_loop\n\ndelay\n ; dispose 'zone delay flag', 'zone section addres' and 'timer mask'\n pop dw\n pop b\n ; get current ticks\n pb TICKS\n inp b, w\n ; get alarm mask\n pw delay_blink_mask\n and w ; calculate\n pop w ; read calculation\n ; if result = 0 - set off\n ; else - set on\n skz\n psh on ; set on\n ret\n \n \nno_alarm_dispose\n pop w ; dispose address of 'section number of zone'\ncheck_arming\n ; get guard sections mask\n pb GUARD_SECTIONS\n inp b, b\n ; get armed sections mask\n pb ARMED_SECTIONS\n inp b, b\n ; calculate armed guard sections mask \n and b\n ; check if need to get all sections types state\n psh all_section_types\n ; read\n pop b\n ; if yes - get other sections types mask\n ; else - continue\n snz\n bra get_monitored\n \nget_other_types\n ; get guard sections mask\n pb GUARD_SECTIONS\n inp b, b\n ; invert it to get other sections type mask\n inv b\n ; combine it wit guard sections mask\n ior b\n\nget_monitored\n pb sections\n ; calculate monitored armed sections mask\n and b\n ; if any of monitoed sections is armed - check fully armed, or not\n ; else - set off\n skz\n bra armed\n ; no need to pop/push, TOS is already zero, set off\n ret\n\narmed\n ; get monitored sections mask\n pb sections\n psh all_section_types\n ; read\n pop b\n ; if yes - get other sections types mask\n ; else - continue\n skz\n bra check_partial\nonly_guard\n ; get guard sections mask\n pb GUARD_SECTIONS\n inp b, b\n ; calculate monitored guard sections mask\n and b\n \ncheck_partial\n ; compare armed sections with monitored guard sections\n cmp b\n ; if equal - full device armed\n ; else - part of it\n skz\n bra partial\n\nfull\n psh on\n ret\n\npartial\n ; read if i am home mode is enabled\n psh enable_im_home\n pop b\n ; if i am home mode is enabled - blink\n ; else - set off\n snz\n ret\n \nblink_im_home\n ; get current ticks\n pb TICKS\n inp b, w\n ; get 'i am home blink mask'\n pw im_home_blink_mask\n ; calculate\n and w\n ; read\n pop w\n ; if result = 0 - set off\n ; else - set on\n skz\n psh on ; set on\n ret","params":[{"name":"sections","format":"^([0-9]|[1-8][0-9]|9[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$","type":"sections","description":[{"iso":"ru","value":"Отслеживаемые разделы"},{"iso":"en","value":"Partitions"},{"iso":"es","value":"Secciones"},{"iso":"de","value":"Überwachte Bereiche"}]},{"name":"indicate_delays","format":"^([01])$","type":"list","default":"1","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Учитывать задержку на Вход/Выход"},{"iso":"en","value":"Consider Entry/Exit Delay"},{"iso":"es","value":"Considere el retraso de entrada/salida"},{"iso":"de","value":"Berücksichtigen Sie die Eingangs-/Ausgangsverzögerung"}]},{"name":"all_section_types","format":"^([01])$","type":"list","default":"0","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"0"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"1"}],"description":[{"iso":"ru","value":"Режим Взят/Снят только для охранных разделов"},{"iso":"en","value":"Armed/Disarmed mode, only for guard partitions"},{"iso":"es","value":"Modo Armado/Desarmado, solo para particiones de guardia"},{"iso":"de","value":"Scharf-/Unscharf-Modus an, nur für Wächterpartitionen"}]},{"name":"enable_im_home","format":"^([01])$","type":"list","default":"0","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Режим «Я дома»"},{"iso":"en","value":"\"I'm at home\" mode"},{"iso":"es","value":"Modo \"Estoy en casa\""},{"iso":"de","value":"„Ich bin zu Hause“-Modus"}]},{"name":"enable_panic","format":"^([01])$","type":"list","default":"0","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Обрабатывать панику"},{"iso":"en","value":"Handle panic"},{"iso":"es","value":"Manejar el pánico"},{"iso":"de","value":"Panik umgehen"}]}],"firmwares":["67111504","21954820","21889283","21954819","22020353","22020355","22020356","22151427","22216961","22216963","22216964","22282499","22348035","22413571","22479107","22544641","22544643","22610177","22610179","22675715","22741251","39452932","22806787","22872323","39584004","22937859","39649540","23068931","39846148","23134467","39911684","39977220","23265539","40042756","40173828","23527683","23593219","23265537","40435972","23658755","23724291","23789827","23855363","40632580","23920899","24117507"]}