{"script_uid":"delay-detect-ljff5y3-d44fdf24-dd","category":[{"iso":"ru","value":"/Охрана"},{"iso":"en","value":"/Protection"},{"iso":"es","value":"/Protección"},{"iso":"de","value":"/Sicherheit"}],"name":[{"iso":"ru","value":"Оповещатель задержки на вход/выход"},{"iso":"en","value":"Entry/exit delay sound indication"},{"iso":"es","value":"Indicación de retraso de entrada/salida"},{"iso":"de","value":"Töne bei Eingangs- / Ausgangsverzögerung"}],"description":[{"iso":"ru","value":"Назначение\nЗвуковое оповещение задержки на вход/выход.\n\nРабота\nВо время задержки идут короткие импульсы, перед окончанием времени задержки импульсы идут чаще.\nПри взятии на охрану один импульс с длительностью 1 сек.\nПри снятии с охраны серия из двух коротких импульсов\n\nПримечание\nПрименять только для проводных выходов"},{"iso":"en","value":"Function\nSound notifications for entry/exit delay.\n\nDuring the delay, there are short sound impulses, before the end of the delay time, the impulses become more frequent.\nArming: one impulse with a duration of 1 sec.\nDisarming: two short impulses."},{"iso":"es","value":"Utilización\nNotificación sonora de retraso de entrada/salida.\n\nDurante el retraso, hay pulsos cortos, antes de que finalice el tiempo de retraso, los pulsos son más frecuentes.\nAl armar: un impulso con una duración de 1 seg.\nAl desarmar: dos pulsos cortos."},{"iso":"de","value":"Funktion\nAudiobenachrichtigungen bei Eingangs- / Ausgangsverzögerung\n\nWährend der Verzögerung gibt es kurze Schallimpulse. Vor dem Ende der Verzögerungszeit werden die Impulse häufiger.\nScharfschaltung: Ein Impuls mit einer Dauer von 1 Sekunde\nUnscharfschaltung: zwei kurzen Impulsen"}],"description_alt":[{"iso":"ru","value":"Назначение<br>Звуковое оповещение задержки на вход/выход.<br><br>Работа:Во время задержки идут короткие импульсы, перед окончанием времени задержки импульсы идут чаще.<br>При взятии на охрану один импульс с длительностью 1 сек.<br>При снятии с охраны серия из двух коротких импульсов<br><br>Примечание<br>Применять только для проводных выходов"},{"iso":"en","value":"Function<br>Sound notifications for entry/exit delay.<br><br>During the delay, there are short sound impulses, before the end of the delay time, the impulses become more frequent.<br>Arming: one impulse with a duration of 1 sec.<br>Disarming: two short impulses."},{"iso":"es","value":"Utilización<br>Notificación sonora de retraso de entrada/salida.<br><br>Durante el retraso, hay pulsos cortos, antes de que finalice el tiempo de retraso, los pulsos son más frecuentes.<br>Al armar: un impulso con una duración de 1 seg.<br>Al desarmar: dos pulsos cortos."},{"iso":"de","value":"Funktion<br>Audiobenachrichtigungen bei Eingangs- / Ausgangsverzögerung<br><br>Während der Verzögerung gibt es kurze Schallimpulse. Vor dem Ende der Verzögerungszeit werden die Impulse häufiger.<br>Scharfschaltung: Ein Impuls mit einer Dauer von 1 Sekunde<br>Unscharfschaltung: zwei kurzen Impulsen"}],"source":"; common TOS sizes\nb equ 0\nw equ 1\ndw equ 2\n\n ;   parameters, uncomment for debug\n;sections equ 13 ; (param) mask that point on tracked sections\n;delay equ 3 ; (param) delay in seconds\n;action equ 1 ; (param) what to do `on` or `off` when active\nblink_mask_1 equ 192\nblink_mask_2 equ 448\nblink_mask_3 equ 16\n;entry_delay_duration equ 45\n;exit_delay_duration equ 60\n\n;statuses:\n; 0 - none\n; 1 - exit delay\n; 2 - entry delay\n; 3 - no alarm detect\n; 4 - alarm detect\n; 5 - disarmed\n\npb macro ; byte\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; push word macro\npw macro\n psh (($1 >> 12) & 15)\n nib (($1 >> 8) & 15)\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; exp instruction with parameters\nex macro\n psh ($1 & 3)\n nib ((($3 & 1) << 3) | ($2 & 3))\n exp\nendm\n\n; mov instruction with parameters\nup macro\n psh (((($1 & 3) | ($2 << 2)) >> 4) & 15)\n nib (($1 & 3) | ($2 << 2) & 15)\n mov\nendm\n\n; BEGIN\n swp b\n dup b\n psh 8\n and b\n pop b\n snz\n bra 3\n pb loop\n jmp b\n dup b\n psh 4\n and b\n pop b\n snz\n bra 3\n pb alarm_detect_disarmed\n jmp b\n dup b\n psh 3\n cmp b\n skz\n bra 3\n pb no_alarm_detect\n jmp b\n dup b\n pop b\n snz\n bra 3\n pb delay_counting\n jmp b\n pb check_exit_delay\n jmp b\n \nalarm_detect_disarmed\n up w, 2 \n dup w\n psh TICKS\n inp b, w\n cmp w\n skn\n bra label2\n up b, 4\n dec b\n snz\n bra label3\n up w, 1\n pop w\n swp b\n dup b\n psh 4\n cmp b\n skz\n bra disar; disarmed\n pw 77 ; 0.3 sec ; alarm_detect\n bra label12\n \ndisar\n pw 40 ; 0.1 sec\n\nlabel12\n psh TICKS\n inp b, w\n add w \n up b, 2\n up b, 4\n psh 1\n xor b\n ret\n\nlabel2\n up b, 2\n up b, 3\n ret\n\nlabel3\n pop dw\n pop b\n psh 0\n ret\n \nno_alarm_detect\n swp b\n pop b\n up w, 1\n dup w\n psh TICKS\n inp b, w\n cmp w\n skn\n bra label11\n pop dw\n psh 0\n ret\n\nlabel11\n up b, 2\n psh 1\n ret\n\ndelay_counting\n dup b\n dec b\n pop b\n snz\n bra continue_counting\n pb ARMED_SECTIONS\n inp b, b\n pop b\n skz\n bra continue_counting; 1\n pop dw; 0\n pop b\n psh 4\n psh TICKS\n inp b, w\n pw 1064 ; 2.1 sec\n add w\n psh 5  ; stat\n psh 0\n pb start_pause\n jmp b\n \ncontinue_counting\n up w, 2\n dup w\n psh TIMESTAMP\n inp b, w\n sub w\n skn\n bra 3\n pb label4\n jmp b\n up b, 4\n dup b\n dec b\n pop b\n snz\n bra ex; ex\n pw entry_delay_duration / 3 ; ent\n bra label5\nex\n pw exit_delay_duration / 3 ; ent\n\nlabel5\n up w, 3\n cmp w\n skp\n bra first; 1\n pw blink_mask_1; 2\n bra label6\nfirst\n pw blink_mask_2\n\nlabel6\n dup w\n psh TICKS\n inp b, w\n and w\n cmp w\n snz\n bra on; 1\n psh 0; 0\n bra label7\non\n psh 1\n\nlabel7\n up b, 4\n pop b\n ret\n\nlabel4\n pop dw\n dec b\n pop b\n skz\n bra label10 ; 1 ent\n pop b  ; 0 ex\n pb GUARD_SECTIONS\n inp b, b\n pb ALARMING_SECTIONS\n inp b, b\n and b\n pop b\n skz\n bra have_alarm\n psh TICKS\n inp b, w\n pw 1024\n add w\n psh 3 ; stat\n psh 0\n\nstart_pause\n psh TIMESTAMP\n inp b, b\n psh 2\n add b\n psh 8\n psh 0\n ret\n \nlabel10\n psh 0\n ret\n \nloop\n swp b\n pop b\n swp b\n dup b\n psh TIMESTAMP\n inp b, b\n cmp b\n skn\n bra cont_loop\n pop w\n ret\n \ncont_loop\n swp b\n psh 0\n ret\n\nhave_alarm\n psh 6\n psh TICKS\n inp b, w\n pw 77 ; 0.3 sec\n add w\n psh 4 ; stat\n psh 0\n ret\n\ncheck_exit_delay\n pop w\n\n pb EXIT_DELAY\n inp b, b\n pop b\n skz\n bra exit_delay_start\n \ncheck_entry_delay\n pb ENTRY_DELAY\n inp b, b\n pop b\n skz\n bra entry_delay_start\n psh 0\n ret\n \nentry_delay_start\n psh 2\n pw entry_delay_duration ; ent\n bra label9\nexit_delay_start\n psh 1\n pw exit_delay_duration ; ex\n \nlabel9\n psh TIMESTAMP\n inp b, w\n add w\n up b, 2\n psh 0\n ret","params":[{"name":"entry_delay_duration","format":"^([0-9]|[1-8][0-9]|9[0-9]|[1-4][0-9]{2}|500)$","default":"45","type":"int","description":[{"iso":"ru","value":"Задержка на вход (сек.)"},{"iso":"en","value":"Entry delay (sec.)"},{"iso":"es","value":"Retraso de entrada (seg.)"},{"iso":"de","value":"Eingangsverzögerung (Sek.)"}]},{"name":"exit_delay_duration","format":"^([0-9]|[1-8][0-9]|9[0-9]|[1-4][0-9]{2}|500)$","default":"60","type":"int","description":[{"iso":"ru","value":"задержка на выход (сек.)"},{"iso":"en","value":"Exit delay (sec.)"},{"iso":"es","value":"Retraso de salida (seg.)"},{"iso":"de","value":"Ausgangsverzögerung (Sek.)"}]}],"firmwares":["67111504","21954820","21889283","21954819","22020353","22020355","22020356","22151427","22216961","22216963","22216964","22282499","22348035","22413571","22479107","22544641","22544643","39452932","22610177","22610179","22675715","22741251","22806787","22872323","39584004","22937859","39649540","23068931","39846148","23134467","39911684","39977220","23265539","40042756","40173828","23527683","23593219","23265537","40435972","23658755","23724291","23789827","23855363","40632580","23920899","24117507","24183043"]}