{"script_uid":"guard-siren-universal-hwtt5-5kw4","category":[{"iso":"ru","value":"/Охрана"},{"iso":"en","value":"/Protection"},{"iso":"es","value":"/Protección"},{"iso":"de","value":"/Sicherheit"}],"name":[{"iso":"ru","value":"Сирена"},{"iso":"en","value":"Siren"},{"iso":"es","value":"Sirena"},{"iso":"de","value":"Sirene"}],"description":[{"iso":"ru","value":"Назначение: Меняет состояние выхода в зависимости от состояния отслеживаемых разделов.\n\nЛогика работы:\n    Выход включается и выключается с периодом 0,5 сек. при тревоге в пожарном разделе (при использовании проводного оповещателя);\n    Выход включен на заданную продолжительность, при тревоге в других разделах;\n    Выход включен на 0,1 сек, при взятии охранных разделов;\n    При снятии охранных разделов, выход два раза включается на 0.1 сек. Интервал, между включениями 0.5 сек;\n\nОсобенности:\nЗадается продолжительность работы выхода (не более 10 минут);\nУчитывается задержка на Вход и Выход;\nОбрабатывается событие «Паника»;\nВыполнение сценария, можно отключить на текущей тревоге, в окне «Управление сценарием»."},{"iso":"en","value":"Purpose: Changes the state of the output depending on the state of the monitored sections.\n\nOperation logic:\n    The output turns on and off with a period of 0.5 sec. in case of an alarm in the fire section (when using a wired siren);\n    The output is turned on for a specified duration, when there is an alarm in other sections;\n    The output is turned on by 0.1 sec, when guarded sections are taken;\n    When guarded sections are removed, the output turns on twice for 0.1 sec. Interval between activations is 0.5 sec;\n\nFeatures:\nThe duration of the output operation is set (no more than 10 minutes);\nEntry and Exit delays are taken into account;\nThe Panic event is processed;\nScript execution can be disabled on the current alarm, in the \"Control window scenario.\""},{"iso":"es","value":"Propósito: Cambia el estado de la salida dependiendo del estado de las secciones monitoreadas.\n\nLógica de operación:\n    La salida se enciende y se apaga con un período de 0,5 seg. en caso de alarma en la sección de incendios (cuando se utiliza una sirena cableada);\n    La salida se enciende por un tiempo especificado, cuando hay una alarma en otras secciones;\n    La salida se enciende por 0.1 seg, cuando se toman las secciones protegidas;\n    Cuando se eliminan las secciones protegidas, la salida se enciende dos veces por 0.1 seg. El intervalo entre activaciones es de 0,5 segundos;\n\nCaracterísticas:\nSe establece la duración de la operación de salida (no más de 10 minutos);\nSe tienen en cuenta los retrasos de entrada y salida;\nSe procesa el evento de pánico;\nLa ejecución del script se puede desactivar en la alarma actual, en el \"Escenario de la ventana de control\""},{"iso":"de","value":"Zweck: Ändert den Zustand des Ausgangs in Abhängigkeit vom Zustand der überwachten Abschnitte.\n\nBetriebslogik:\n    Der Ausgang schaltet mit einer Periode von 0,5 s ein und aus. bei Alarm im Brandabschnitt (bei Verwendung einer kabelgebundenen Sirene);\n    Der Ausgang wird für eine bestimmte Dauer eingeschaltet, wenn es einen Alarm in anderen Abschnitten gibt;\n    Der Ausgang wird für 0,1 Sek. eingeschaltet, wenn bewachte Bereiche eingenommen werden;\n    Wenn bewachte Bereiche entfernt werden, schaltet sich der Ausgang zweimal für 0,1 Sek. ein. Das Intervall zwischen den Aktivierungen beträgt 0,5 Sek.;\n\nEigenschaften:\nDie Dauer des Ausgabevorgangs wird eingestellt (nicht mehr als 10 Minuten);\nEintritts- und Austrittsverzögerungen werden berücksichtigt;\nDas Panikereignis wird verarbeitet;\nDie Skriptausführung kann deaktiviert werden zum aktuellen Alarm im \"Steuerungsfenster-Szenario\""}],"description_alt":[{"iso":"ru","value":"<i><u>Назначение:</i></u> Меняет состояние выхода в зависимости от состояния отслеживаемых разделов.<br><br><i><u>Логика работы:</i></u><br>    Выход включается и выключается с периодом 0,5 сек. при тревоге в пожарном разделе (при использовании проводного оповещателя);<br>    Выход включен на заданную продолжительность, при тревоге в других разделах;<br>    Выход включен на 0,1 сек, при взятии охранных разделов;<br>    При снятии охранных разделов, выход два раза включается на 0.1 сек. Интервал, между включениями 0.5 сек;<br><br><i><u>Особенности:</i></u><br>Задается продолжительность работы выхода (не более 10 минут);<br>Учитывается задержка на Вход и Выход;<br>Обрабатывается событие «Паника»;<br>Выполнение сценария, можно отключить на текущей тревоге, в окне «Управление сценарием»."},{"iso":"en","value":"<i><u>Purpose:</i></u> Changes the exit status depending on the status of the monitored partitions.<br><br><i><u>Operation logic:</i></u><br>    The output turns on and off with a period of 0.5 sec. in case of an alarm in the fire section (when using a wired siren);<br>    The output is switched on for a specified duration, in case of alarm in other sections;<br>    The output is on for 0.1 sec, when the partitions are armed; times turns on for 0.1 sec. Interval, between activations 0.5 sec;<br><br><i><u>Features:</i></u><br>The duration of the output is set (no more than 10 minutes);<br>The delay for Entry and Exit is taken into account; <br>The \"Panic\" event is being processed;<br>Script execution can be disabled on the current alarm, in the \"Scenario management\" window"},{"iso":"es","value":"<i><u>Propósito:</i></u> Cambia el estado de salida dependiendo del estado de las particiones monitoreadas.<br><br><i><u>Lógica de operación:</i></u><br>    La salida se enciende y se apaga con un período de 0,5 seg. en caso de alarma en la sección de incendios (cuando se utiliza una sirena cableada);<br>    La salida se enciende durante un tiempo especificado, en caso de alarma en otras secciones;<br>    La salida se enciende durante 0,1 segundos, cuando la las particiones están armadas; veces se enciende durante 0,1 seg. Intervalo, entre activaciones 0,5 seg;<br><br><i><u>Características:</i></u><br>Se establece la duración de la salida (no más de 10 minutos);<br>La demora para Se tiene en cuenta Entrada y Salida; <br>El evento \"Pánico\" se está procesando;<br>La ejecución del script se puede desactivar en la alarma actual, en la ventana \"Gestión de escenarios\""},{"iso":"de","value":"<i><u>Zweck:</i></u> Ändert den Exit-Status abhängig vom Status der überwachten Partitionen.<br><br><i><u>Operationslogik:</i></u><br>    Der Ausgang schaltet mit einer Periode von 0,5 s ein und aus. bei Alarm im Brandabschnitt (bei Verwendung einer kabelgebundenen Sirene);<br>    Der Ausgang wird bei Alarm in anderen Abschnitten für eine bestimmte Dauer eingeschaltet;<br>    Der Ausgang ist für 0,1 s eingeschaltet, wenn der Partitionen sind bewaffnet; Mal schaltet sich für 0,1 Sek. ein. Intervall, zwischen Aktivierungen 0,5 Sek.;<br><br><i><u>Eigenschaften:</i></u><br>Die Dauer der Ausgabe wird eingestellt (nicht mehr als 10 Minuten);<br>Die Verzögerung für Ein- und Ausfahrt werden berücksichtigt; <br>Das Ereignis \"Panik\" wird verarbeitet;<br>Die Skriptausführung kann für den aktuellen Alarm im Fenster \"Szenarioverwaltung\" deaktiviert werden."}],"source":"; common TOS sizes\nb equ 0\nw equ 1\ndw equ 2\n\n;sections equ 7 ; (param) monitored sections mask\n;timer equ 5 ; (param) time of alarm\n;include_panic equ 0 ; (param) include panic alarm\n;include_arm_disarm_signals equ 1 ; (param) include signals of arm/disarm\n;include_blink_delay equ 1 ; (param) flag that need to indicate delay\n;blink_on_fire equ 1 ; (param) flag that need to blink on fire\nmask equ 128 ; mask of blink\ndelay_blink_mask equ 448\n\npb macro ; byte\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; push word macro\npw macro\n psh (($1 >> 12) & 15)\n nib (($1 >> 8) & 15)\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\nup macro\n psh (((($1 & 3) | ($2 << 2)) >> 4) & 15)\n nib (($1 & 3) | ($2 << 2) & 15)\n mov\nendm\n\n; stack template\n; - last state - 1 byte\n; - signal counter - 1 byte\n; - armed flag - 1 byte\n; - was walarmed flag - 1 byte\n; - timer end time - 2 bytes\n; - -|-|-|-\n\n;BEGIN\ncheck_signal\n swp b ; bring 'signal counter' to top\n ; if 'signal counter' has value - check timer\n ; else - check arming guard sections\n snz\n bra no_signal\nhas_signal\n pb check_signal_timer\n jmp b\nno_signal\n pop b ; dispose 'signal counter'\n ; get switch\n pb HAS_SWITCH\n inp b, b\n pop b ; read switch\n ; if has switch - disable\n ; else - check delays\n skz\n bra check_last_state\n pop b ; dispose 'last state'\n bra check_delays\ncheck_last_state\n pop b ; read 'last state'\n ; if was off - no need to turning off, check arming\n skz\n bra manually_disable\n pb check_arming ; 0\n jmp b\nmanually_disable\n up dw, 1 ; bring 'alarmed flag' and 'timer end time' to top\n pop dw ; dispose 'alarmed flag' and 'timer end time'\n psh 1 ; set 'alarmed flag'\n pb swap_and_off\n jmp b\n \ncheck_delays\n ; get entry delay\n psh ENTRY_DELAY\n inp b, b\n ; get exit delay\n psh EXIT_DELAY\n inp b, b\n ior b ; merge exit and entry delays\n pop b ; read delay flag\n ; if has any delay - process delay\n ; else check arming\n snz\n bra check_arming\ndelay\n psh 0 ; set 'signal counter'\n ; get flag need to blink in delay\n psh include_blink_delay\n pop b ; read flag\n ; if has flag - blink\n ; else - just set off\n snz\n bra off\nblink_delay\n ; get current ticks\n psh TICKS\n inp b, w\n pw delay_blink_mask ; push blinking mask to stack\n and w ; calculate matching ticks with a mask\n pop w ; read result\n ; if match with mask - set on\n ; else - set off\n psh 0\n snz\n nib 1\n ret\n \noff\n psh 0 ; set off relay state\n ret\n\ncheck_arming\n dup b ; save 'armed flag'\n ; get guard sections mask\n psh GUARD_SECTIONS\n inp b, b\n pb sections ; get monitored sections mask\n and b ; calculate which guard sections are monitored\n ; get armed sections mask\n psh ARMED_SECTIONS\n inp b, b\n pb sections ; get monitored sections mask\n and b ; calculate which armed sections are monitored\n snz\n bra disarmed\n cmp b\n skz\n bra nothing\narmed\n psh 1\n bra check_changing\nnothing\n pop b\n bra check_alarmed_flag\ndisarmed\n pop w\n psh 0\ncheck_changing\n xor b ; calculate arm changing status\n pop b\n ; if device did not change arm status - check alarm\n ; else - check last arm status\n skz\n bra check_armed_flag ; 1\ncheck_alarmed_flag\n swp b ; bring 'alarmed flag' to top\n pop b ; read 'alarmed flag'\n ; if alarmed - check if alarms there still\n ; else - go check panic\n skz\n bra check_if_has_any_alarm\n pb check_for_panic\n jmp b\n\ncheck_if_has_any_alarm\n ; get panic state considering 'include panic' flag\n pb PANIC\n inp b, b\n psh include_panic\n and b\n ; get alarms considering monitored sections\n psh ALARMING_SECTIONS\n inp b, b\n pb sections\n and b\n ior b\n pop b\n psh 0 ; set base of 'alarmed' flag\n ; if there still some alarm - set 'alarmed' = 1\n ; else - left 'alarmed' = 0\n skz\n nib 1 ; set 'alarmed'\n pb swap_and_off\n jmp b\n \ncheck_armed_flag\n dup b ; save 'armed flag'\n pop b ; check 'armed flag'\n ; if was armed - dispose armed flag\n ; else - set armed and make signal\n snz\n bra set_armed_and_make_signal\ndispose_armed_flag\n swp w ; bring 'timer end time' to top\n pop w ; dispose 'timer end time'\n pop b ; dispose 'armed' flag\n psh 0 ; set 0 to 'armed' flag\n psh 0 ; set 'signal counter' initial value\n psh include_arm_disarm_signals ; get include arm/disarm signals parameter\n pop b ; read include arm/disarm signals\n ; if include arm/disarm signal - set 'signal counter' = 8\n ; else leave 'signal counter' = 0\n skz\n nib 8 ; set 'signal counter'\n bra off2\n\nset_armed_and_make_signal\n swp w ; bring 'timer end time' to top\n pop w ; dispose 'timer end time'\n pop b ; dispose 'armed flag'\n psh 1 ; set 'armed flag'\n psh 0 ; set 'signal counter' initial value\n psh include_arm_disarm_signals ; get include arm/disarm signals parameter\n pop b ; read include arm/disarm signals\n ; if include arm/disarm signal - set 'signal counter' = 8\n ; else leave 'signal counter' = 0\n skz\n nib 2 ; set 'signal counter' = 2\noff2\n psh 0\n ret\n \ncheck_signal_timer\n up w, 4 ; bring 'timer end time' to top\n dup w\n pop w\n snz\n bra timeout4\n dup w ; save 'timer end time'\n ; get current ticks\n psh TICKS\n inp b, w\n ; compare 'timer end time' and current ticks\n ; if current ticks is greater - time is out\n ; else - continue\n cmp w\n skp\n bra timeout4\ncontinue_signal_or_gap\n up dw, 2 ; bring 'signal counter', 'last state', alarmed flag' and 'armed flag' to top\n swp b ; bring 'last state' to top\n ret\n\ntimeout4\n pop w ; dispose 'timer end time'\n shr 1 ; shift 'signal counter' right\n dup b ; save 'signal counter'\n psh 2 ; push 00000010 mask to stack\n ; compare 00000010 with 'signal counter'\n ; if equal - set timer for 128 ticks\n ; else - check with 00000001 mask\n cmp b\n skz\n bra check_00000101 ; 1\nsignal_gap_for_128_ticks\n pw 128 ; 0\n bra start_n_timer\ncheck_00000101\n dup b ; save 'signal counter'\n psh 5 ; push 00000101 to stack\n ; check 'signal counter' matching 00000101 \n ; if match - set timer for 32 ticks\n ; else - dispose 'last state' and 'signal counter' and set off\n and b\n pop b\n skz\n bra signal_for_32_ticks\nstop_signaling_dispose\n pb popw_and_set_off ; 1\n jmp b\nsignal_for_32_ticks\n pw 32 ; 0\n \nstart_n_timer\n ; get current ticks\n psh TICKS\n inp b, w\n add w ; calculate 'timer end time'\n up dw, 2 ; bring 'signal counter', 'last state', 'armed flag' and 'alarmed flag' to top\n swp b ; bring 'last state' to top\n ; flip the 'last value' (1 to 0, 0 to 1)\n psh 1\n xor b\n ret\n \ncheck_for_panic\n ; get panic status considering include panic flag\n pb PANIC\n inp b, b\n psh include_panic\n and b\n pop b ; read panic status\n ; if panic - check for timer\n ; else - check alarming\n snz\n bra check_alarming\n psh 0 ; set 'fire flag'\n bra check_for_timer\n\ncheck_alarming\n ; get alarming sections mask\n psh ALARMING_SECTIONS\n inp b, b\n pb sections\n and b ; calculate monitored alarming sections mask\n ; if has alarms - check if it's fire\n ; else - no alarm, set off\n skz\n bra check_is_fire\n ; already have 0 on top use it as 'alarmed flag'\n pb swap_and_off\n jmp b\n\ncheck_is_fire\n ; get fire sections mask\n psh FIRE_SECTIONS\n inp b, b\n and b ; calculate monitored fire alarms\n pop b ; read monitored fire alarms\n psh 0 ; set base 'fire alarm'\n ; if has fire alarm - set 'fire alarm' flag = 1\n ; else - leave 'fire alarm' = 0\n skz\n nib 1 ; set 'fire alarm' flag = 1\n \ncheck_for_timer ; 0 not fire\n swp w ; bring 'timer end time' to top\n ; if no timer started - start timer\n ; else - check timer\n skz\n bra check_timer\n pop w ; dispose timer place\n bra start_timer\n\nset_off\n swp w ; bring 'timer end time' to top\npopw_and_set_off\n pop w ; dispose 'timer end time'\n psh 0 ; set 'signal counter' = 0\n psh 0 ; set off relay action\n ret\n\nstart_timer\n psh TIMESTAMP\n inp b, w ; get current timestamp\n pw timer * 60\n add w ; calculate 'timer end time'\n bra set_on\n \ncheck_timer\n dup w ; save 'timer end time'\n psh TIMESTAMP\n inp b, w ; get 'current timestamp'\n ; compare 'current timestamp' and 'timer end time'\n ; if 'current timestamp' is greater - time is out\n ; else - continue, set on\n cmp w\n skp\n bra timeout\n \nset_on\n swp w ; bring 'fire alarm' and 'armed flag' to top\n ; read 'fire alarm' flag\n pop b\n ; if 'common alarm' flag is 0 - process fire siren\n ; else - regular siren\n skz\n bra fire ; 1\njust_on\n psh 0 ; set 'alarmed flag'\n bra swap_and_on\n \ntimeout\n pop w ; dispose 'timer end time'\n pop b ; dispose 'fire alarm' flag\n psh 1 ; set 'alarmed flag'\n swp b ; bring 'armed' to top\n bra set_off\n\nfire\n psh blink_on_fire\n pop b\n snz\n bra just_on\n psh 0 ; set 'alarmed flag'\n\nblink\n ; get ticks\n psh TICKS\n inp b, b\n pb mask ; push blinking mask to stack\n and b ; calculate matching ticks with a mask\n pop b ; read result\n ; if match with mask - set off\n ; else - set on relay action\n skz\n bra swap_and_off\nswap_and_on\n swp b ; bring 'armed' to top\n psh 0 ; set 'signal counter' = 0\n psh 1 ; set on relay action\n ret\nswap_and_off\n swp b ; bring 'armed' to top\n psh 0 ; set 'signal counter' = 0\n psh 0 ; set off relay action\n ret","extra":{"switch":{"rows":[{"items":[{"content":[{"iso":"ru","value":"Отключить"},{"iso":"en","value":"Turn Off"},{"iso":"es","value":"Apagar"},{"iso":"de","value":"Ausschalten"}],"value":1}]}],"size":1}},"params":[{"name":"sections","type":"sections","format":"^([0-9]|[1-8][0-9]|9[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$","description":[{"iso":"ru","value":"Отслеживаемые разделы"},{"iso":"en","value":"Partitions"},{"iso":"es","value":"Secciones "},{"iso":"de","value":"Überwachte Bereiche"}]},{"name":"timer","format":"^([1-9]|10)$","type":"int","description":[{"iso":"ru","value":"Продолжительность работы (мин)"},{"iso":"en","value":"Duration (min)"},{"iso":"es","value":"Duración (min)"},{"iso":"de","value":"Betriebsdauer (Min)"}]},{"name":"include_panic","format":"^([01])$","type":"list","default":"0","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Обрабатывать панику"},{"iso":"en","value":"Handle panic"},{"iso":"es","value":"Manejar el pánico"},{"iso":"de","value":"Panik umgehen"}]},{"name":"include_blink_delay","format":"^([01])$","type":"list","default":"1","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Задержка на Вход/Выход"},{"iso":"en","value":"Entry/Exit Delay"},{"iso":"es","value":"Retraso de entrada/salida"},{"iso":"de","value":"Eingangs-/Ausgangsverzögerung"}]},{"name":"blink_on_fire","format":"^([01])$","type":"list","default":"1","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Проводной звуковой оповещатель"},{"iso":"en","value":"Wired sounder"},{"iso":"es","value":"Sirena cableada"},{"iso":"de","value":"Kabelgebundener Echolot"}]},{"name":"include_arm_disarm_signals","format":"^([01])$","type":"list","default":"1","extra":[{"name":"yes","description":[{"iso":"ru","value":"Да"},{"iso":"en","value":"ON"},{"iso":"es","value":"Activado"},{"iso":"de","value":"Ja"}],"value":"1"},{"name":"no","description":[{"iso":"ru","value":"Нет"},{"iso":"en","value":"OFF"},{"iso":"es","value":"Desactivado"},{"iso":"de","value":"Nein"}],"value":"0"}],"description":[{"iso":"ru","value":"Оповещение Взят/Снят"},{"iso":"en","value":"Notification Armed/Disarmed"},{"iso":"es","value":"Notificación Armado/Desarmado"},{"iso":"de","value":"Benachrichtigung scharf/unscharf"}]}],"firmwares":["22544641","22544643","22610177","22610179","22675715","22741251","39452932","22806787","22872323","39584004","22937859","39649540","23068931","39846148","23134467","39911684","39977220","23265539","40042756","40173828","23527683","23593219","23265537","40435972","23658755","23724291","23789827","23855363","40632580","23920899","24117507","24183043"]}