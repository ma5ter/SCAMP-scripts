{"script_uid":"smart-impuls-asdfg-fhjdf9-g4t-im","category":[{"iso":"ru","value":"/Умный дом"},{"iso":"en","value":"/Smart Home"},{"iso":"es","value":"/Casa inteligente"},{"iso":"de","value":"/Smart Home"}],"name":[{"iso":"ru","value":"Импульсный"},{"iso":"en","value":"Impulse"},{"iso":"es","value":"De impulso"},{"iso":"de","value":"Impuls"}],"description":[{"iso":"ru","value":"Сценарий 'Импульсный' позволяет дистанционно управлять переключением состояния выхода на заданный промежуток времени."},{"iso":"en","value":"The 'Impulse' scenario allows to remotely switch the output for specified period of time."},{"iso":"es","value":"El escenario 'De impulso' le permite controlar de forma remota la conmutación del estado de la salida a un período de tiempo específico."},{"iso":"de","value":"Das Szenario „Impuls“ schaltet den Ausgang per Fernsteuerung für die festgelegte Dauer um."}],"description_alt":[{"iso":"ru","value":"Сценарий <b>Импульсный</b> позволяет дистанционно управлять переключением состояния реле на заданный промежуток времени.\n\n"},{"iso":"en","value":"The <b> Impulse </b> scenario allows to remotely switch the output for specified period of time."},{"iso":"es","value":"El escenario <b>De impulso</b> le permite controlar de forma remota la conmutación del estado de la salida a un período de tiempo específico."},{"iso":"de","value":"Das Szenario <b>Impuls</b> ermöglicht das Umschalten des Relais für die festgelegte Dauer per Fernsteuerung."}],"case":[{"iso":"ru","value":"1. Открытие замка на несколько секунд"}],"source":"; common TOS sizes\nb equ 0\nw equ 1\ndw equ 2\n\n;timer equ 5\n;action equ 1\n\npb macro ; byte\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; push word macro\npw macro\n psh (($1 >> 12) & 15)\n nib (($1 >> 8) & 15)\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; exp instruction with parameters\nex macro\n psh ($1 & 3)\n nib ((($3 & 1) << 3) | ($2 & 3))\n exp\nendm\n\n; mov instruction with parameters\nup macro\n psh (((($1 & 3) | ($2 << 2)) >> 4) & 15)\n nib (($1 & 3) | ($2 << 2) & 15)\n mov\nendm\n\n; BEGIN\n \n ; get switch\n pb HAS_SWITCH\n inp b, b\n dup b ; save switch value\n ; get last state\n ; if 1 - was off\n ; else - was on\n psh action\n up b, 3\n xor b\n ; check last state and switch\n ; if was on and has switch or was off and no switch - dispose and set off\n ; if was on and no switch or was off and has switch - check for timer\n cmp b\n snz\n bra check_switch\n pop b ; dispose switch value\n pop dw ; dispose timer\n bra set_off\n \ncheck_switch\n ; read switch\n pop b\n ; if has switch - start timer\n ; else - check for timer\n skz\n bra start_timer\n \ncheck_for_timer\n ; save 'timer end time' and get z-flag\n dup dw\n ; if no 'timer end time' - start timer and set on\n ; else - check timer\n snz\n bra set_off\n \ncheck_timer\n ; get 'current timestamp'\n psh TIMESTAMP\n inp b, dw\n ; compare it with 'timer end time'\n ; if 'timer end time' greater - set on and continue\n ; else - set off\n cmp dw\n skn\n bra set_on\n pop dw ; dispose 'timer end time'\n bra set_off\n\nstart_timer\n ; get current timestamp\n psh TIMESTAMP\n inp b, dw\n ; get 'duration'\n pw timer\n ex w, dw, 1\n add dw ; calculate 'timer end time'\n\nset_on\n psh action & 1\n ret\n \nset_off\n psh ~action & 1\n ret","extra":{"switch":{"rows":[{"items":[{"content":[{"iso":"ru","value":"Импульс"},{"iso":"en","value":"Impulse"},{"iso":"es","value":"Impulso"},{"iso":"de","value":"Impuls"}],"value":1}]}],"size":1}},"params":[{"name":"timer","format":"^([0-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|10[0-7][0-9]{2}|10800)$","type":"int","description":[{"iso":"ru","value":"Время (сек)"},{"iso":"en","value":"Time (sec)"},{"iso":"es","value":"Tiempo (seg.)"},{"iso":"de","value":"Zeit (Sek.)"}]},{"name":"action","format":"^([01])$","type":"list","default":"1","extra":[{"name":"turn_on","description":[{"iso":"ru","value":"Включать реле"},{"iso":"en","value":"Turn on "},{"iso":"es","value":"Encender "},{"iso":"de","value":"Relais einschalten"}],"value":"1"},{"name":"turn_off","description":[{"iso":"ru","value":"Выключать реле"},{"iso":"en","value":"Turn off "},{"iso":"es","value":"Apagar "},{"iso":"de","value":"Relais ausschalten"}],"value":"0"}],"description":[{"iso":"ru","value":"Действие"},{"iso":"en","value":"Action"},{"iso":"es","value":"Acción"},{"iso":"de","value":"Aktion"}]}],"firmwares":["67111504","21954820","21889283","21954819","22020353","22020355","22020356","22151427","22216961","22216963","22216964","22282499","22348035","22413571","22479107","22544641","22544643","22610177","22610179","22675715","22741251","39452932","22806787","22872323","39584004","22937859","39649540","23068931","39846148","23134467","39911684","39977220","23265539","40042756","40173828","23527683","23593219","23265537","40435972","23658755","23724291","23789827","23855363","40632580","23920899","24117507","24183043"]}