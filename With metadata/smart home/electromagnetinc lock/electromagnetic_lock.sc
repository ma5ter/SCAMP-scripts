{"script_uid":"elctro-lock-magnet-h3f33-ht5-elf","category":[{"iso":"ru","value":"/Умный дом"},{"iso":"en","value":"/Smart Home"},{"iso":"es","value":"/Casa inteligente"},{"iso":"de","value":"/Smart Home"}],"name":[{"iso":"ru","value":"Электромагнитный замок"},{"iso":"en","value":"Electromagnetic lock"},{"iso":"es","value":"Cerradura electromagnética"},{"iso":"de","value":"Elektromagnetisches Schloss"}],"description":[{"iso":"ru","value":"Назначение сценария:\nУправление электромагнитным замком непосредственно или имитация кнопки «выход» совместно со сторонним контроллером.\n\nПринцип работы:\n  • Реле выключается при нажатии кнопки управления «Открыть».\n  • Реле включается по истечении времени открытия замка.\n  • Реле включается при повторном нажатии кнопки «Открыть» в момент действия времени открытия замка, отсчет времени прекращается.\n\nДополнительные параметры:\nИнверсия."},{"iso":"en","value":"Scenario purpose:\nControlling the electromagnetic lock directly or simulating the «exit» button in conjunction with a third-party controller.\n\nPrinciple of operation:\n  • The relay is turned off when the «Open» control button is pushed.\n  • The relay is turned on after the set time for opening the lock.\n  • The relay is turned on when the «Open» button is pushed again at the moment of the lock opening time, the countdown stops.\nAdditional parameters:\nInversion."},{"iso":"es","value":"Designación del escenario:\nControl directo de la cerradura electromagnética o simulación del botón de “Salida” junto con un controlador de terceros.\n\nPrincipio de funcionamiento:\n• El relé se desactiva cuando se presiona el botón de control “Abrir”.\n• El relé se activa cuando ha transcurrido el tiempo de apertura de la cerradura.\n• El relé se activa cuando se presiona nuevamente el botón “Abrir” en el momento del tiempo de apertura de la cerradura, la cuenta regresiva se detiene.\n\nOpciones extra:\nInversión."},{"iso":"de","value":"Funktion:\nDirekte Steuerung des elektromagnetischen Schlosses oder Simulation der Taste “Beenden” in Verbindung mit einem Drittanbieter-Controller.\n\nFunktionsprinzip:\n  • Das Relais schaltet sich aus, sobald die Taste «Öffnen» gedrückt wird.\n  • Das Relais schaltet sich ein, sobald die Schlossöffnungszeit abgelaufen ist.  • Das Relais schaltet sich ein, sobald die Taste “Öffnen” zum Zeitpunkt der Schlossöffnungszeit erneut gedrückt wird und der Countdown stoppt.\n\nZusätzliche Optionen:\nInversion."}],"description_alt":[{"iso":"ru","value":"Назначение сценария:<br>Управление электромагнитным замком непосредственно или имитация кнопки «выход» совместно со сторонним контроллером.<br><br>Принцип работы:<br>  • Реле выключается при нажатии кнопки управления «Открыть».<br>  • Реле включается по истечении времени открытия замка.<br>  • Реле включается при повторном нажатии кнопки «Открыть» в момент действия времени открытия замка, отсчет времени прекращается.<br><br>Дополнительные параметры:<br>Инверсия."},{"iso":"en","value":"Scenario purpose:<br>Controlling the electromagnetic lock directly or simulating the «exit» button in conjunction with a third-party controller.<br><br>Principle of operation:<br>  • The relay is turned off when the «Open» control button is pushed.<br>  • The relay is turned on after the set time for opening the lock.<br>  • The relay is turned on when the «Open» button is pushed again at the moment of the lock opening time, the countdown stops.<br>Additional parameters:<br>Inversion."},{"iso":"es","value":"Designación del escenario:<br>Control directo de la cerradura electromagnética o simulación del botón de “Salida” junto con un controlador de terceros.<br><br>Principio de funcionamiento:<br>• El relé se desactiva cuando se presiona el botón de control “Abrir”.<br>• El relé se activa cuando ha transcurrido el tiempo de apertura de la cerradura.<br>• El relé se activa cuando se presiona nuevamente el botón “Abrir” en el momento del tiempo de apertura de la cerradura, la cuenta regresiva se detiene.<br><br>Opciones extra:<br>Inversión."},{"iso":"de","value":"Funktion:<br>Direkte Steuerung des elektromagnetischen Schlosses oder Simulation der Taste “Beenden” in Verbindung mit einem Drittanbieter-Controller.<br><br>Funktionsprinzip:<br>  • Das Relais schaltet sich aus, sobald die Taste «Öffnen» gedrückt wird.<br>  • Das Relais schaltet sich ein, sobald die Schlossöffnungszeit abgelaufen ist.  • Das Relais schaltet sich ein, sobald die Taste “Öffnen” zum Zeitpunkt der Schlossöffnungszeit erneut gedrückt wird und der Countdown stoppt.<br><br>Zusätzliche Optionen:<br>Inversion."}],"source":"; common TOS sizes\nb equ 0\nw equ 1\ndw equ 2\n\n; setting on is 0 for relay on usual state, 1 - on inversion\n\n;duration equ 5 ; (param) duration of relay action after switch\n;inversion equ 0 ; (param) inversion of relay action\n\npb macro ; byte\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; push word macro\npw macro\n psh (($1 >> 12) & 15)\n nib (($1 >> 8) & 15)\n psh (($1 >> 4) & 15)\n nib ($1 & 15)\nendm\n\n; exp instruction with parameters\nex macro\n psh ($1 & 3)\n nib ((($3 & 1) << 3) | ($2 & 3))\n exp\nendm\n\n; BEGIN\n ; check last state considering inversion\n ; if was active - check timer\n ; else - check switch\n psh inversion\n xor b\n pop b\n skz\n bra check_switch ; was off\n ; was on, check_timer\n\ncheck_timer\n dup dw ; save 'timer end time'\n psh TIMESTAMP\n inp b, dw\n ; compare 'current tme' and 'timer end time'\n ; if 'current time' greater - dispose all and set off\n ; else - check switch for off\n cmp dw\n skn\n bra check_switch_for_off\n pop dw\n bra set_off\n \ncheck_switch_for_off\n ; read switch value\n pb HAS_SWITCH\n inp b, b\n pop b\n ; if has switch - set of\n ; else - continue, set on\n snz\n bra set_on\n pop dw\n bra set_off\n \ncheck_switch\n ; read if has switch\n ; if has - start timer and set on\n ; else - set off\n pb HAS_SWITCH\n inp b, b\n pop b\n snz\n bra set_off ; wait\n ; start timer and switch on\n \nstart_timer\n psh TIMESTAMP\n inp b, dw\n pw duration\n ex w, dw, 1\n add dw ; calculate 'timer end time'\n\nset_on\n psh inversion & 1\n ret\n \nset_off\n psh ~inversion & 1\n ret","extra":{"switch":{"rows":[{"items":[{"content":[{"iso":"ru","value":"Открыть"},{"iso":"en","value":"Open"},{"iso":"es","value":"Abierto"},{"iso":"de","value":"öffnen"}],"value":1}]}],"size":1}},"params":[{"name":"duration","format":"^([0-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|10[0-7][0-9]{2}|10800)$","type":"int","description":[{"iso":"ru","value":"Время (сек)"},{"iso":"en","value":"Time (sec)"},{"iso":"es","value":"Tiempo (seg.)"},{"iso":"de","value":"Zeit (Sek.)"}]},{"name":"inversion","format":"^([01])$","type":"list","default":"0","extra":[{"name":"default","description":[{"iso":"ru","value":"Обычный режим"},{"iso":"en","value":"Default"},{"iso":"es","value":"Modo normal"},{"iso":"de","value":"Normaler Modus"}],"value":"0"},{"name":"inversion","description":[{"iso":"ru","value":"Инверсия"},{"iso":"en","value":"Inversion"},{"iso":"es","value":"Inversión"},{"iso":"de","value":"Inversion"}],"value":"1"}],"description":[{"iso":"ru","value":"Инверсия"},{"iso":"en","value":"Inversion"},{"iso":"es","value":"Inversión"},{"iso":"de","value":"Inversion"}]}],"firmwares":["67111504","21954820","21889283","21954819","22020353","22020355","22020356","22151427","22216961","22216963","22216964","22282499","22348035","22413571","22479107","22544641","22544643","39452932","22610177","22610179","22675715","22741251","22806787","22872323","39584004","22937859","39649540","23068931","39846148","23134467","39911684","39977220","23265539","40042756","40173828","23527683","23593219","23265537","40435972","23658755","23724291","23789827","23855363","40632580","23920899","24117507","24183043"]}